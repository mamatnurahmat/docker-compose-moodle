{"version":3,"file":"profile.min.js","sources":["../src/profile.js"],"sourcesContent":["/* eslint-disable no-unused-vars */\n/* eslint-disable no-console */\n// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * @module     theme_remui/profile\n * @copyright (c) 2023 WisdmLabs (https://wisdmlabs.com/)\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n\"use strict\";\ndefine([\n    'jquery',\n    'core/ajax',\n    'core/notification',\n    'core_message/message_drawer_helper'\n], function ($, Ajax, Notification, MessageDrawerHelper) {\n    var SELECTORS = {\n        ERROR: 'div#error-message',\n        DANGER: 'alert-danger',\n        SUCCESS: 'alert-success',\n        PROFILEABOUTMEWRAPPER: '.profile-about-me-wrapper',\n        EDITICON: '.about-me-edit-icon-wrapper .edw-icon-Edit',\n        CANCELICON: '.about-me-edit-icon-wrapper .edw-icon-Cancel',\n        EDITPROFILEDETAILSWRAPPER: '.edit-profile-details-wrapper',\n    };\n    $('#editprofile .form-horizontal #btn-save-changes').click(function () {\n        $(SELECTORS.ERROR).show();\n        $(SELECTORS.ERROR).removeClass(SELECTORS.DANGER).addClass(SELECTORS.SUCCESS);\n        $(SELECTORS.ERROR).find('p').html(\"Saving...\");\n\n        var fname = $('#first_name').val();\n        var lname = $('#surname').val();\n        var phonenumber = $('#phone_number').val();\n        var department = $('#department').val();\n        var country = $('#editprofile .form-horizontal #country option:selected').val();\n        var countryname = $('#editprofile .form-horizontal #country option:selected').text();\n        var city = $.trim($('#city').val());\n        var description = $.trim($('#description').val());\n        var address = $.trim($('#address').val());\n\n        if (fname === '') {\n            $(SELECTORS.ERROR).show();\n            $(SELECTORS.ERROR).removeClass(SELECTORS.SUCCESS).addClass(SELECTORS.DANGER);\n            $(SELECTORS.ERROR).find('p').html(M.util.get_string('enterfirstname', 'theme_remui'));\n            $('#first_name').focus();\n            return false;\n        }\n\n        if (lname === '') {\n            $(SELECTORS.ERROR).show();\n            $(SELECTORS.ERROR).removeClass(SELECTORS.SUCCESS).addClass(SELECTORS.DANGER);\n            $(SELECTORS.ERROR).find('p').html(M.util.get_string('enterlastname', 'theme_remui'));\n            $('#surname').focus();\n            return false;\n        }\n\n\n        var phonenoregex = /^\\d{10}$/;\n        if (!phonenumber == '') {\n            if (!phonenumber.match(phonenoregex)) {\n                $(SELECTORS.ERROR).show();\n                $(SELECTORS.ERROR).removeClass(SELECTORS.SUCCESS).addClass(SELECTORS.DANGER);\n                $(SELECTORS.ERROR).find('p').html(M.util.get_string('entervalidphoneno', 'theme_remui'));\n                $('#phone_number').focus();\n                return false;\n            }\n        }\n        if (address.length > 240) {\n            $(SELECTORS.ERROR).show();\n            $(SELECTORS.ERROR).removeClass(SELECTORS.SUCCESS).addClass(SELECTORS.DANGER);\n            $(SELECTORS.ERROR).find('p').html(\"max 250 chars are allowed\");\n            $('#address').focus();\n            return false;\n        }\n\n        if (fname.length > 100) {\n            $(SELECTORS.ERROR).show();\n            $(SELECTORS.ERROR).removeClass(SELECTORS.SUCCESS).addClass(SELECTORS.DANGER);\n            $(SELECTORS.ERROR).find('p').html(\"max 100 chars are allowed\");\n            $('#first_name').focus();\n            return false;\n        }\n\n        if (lname.length > 100) {\n            $(SELECTORS.ERROR).show();\n            $(SELECTORS.ERROR).removeClass(SELECTORS.SUCCESS).addClass(SELECTORS.DANGER);\n            $(SELECTORS.ERROR).find('p').html(\"max 100 chars are allowed\");\n            $('#surname').focus();\n            return false;\n        }\n        if (department.length > 100) {\n            $(SELECTORS.ERROR).show();\n            $(SELECTORS.ERROR).removeClass(SELECTORS.SUCCESS).addClass(SELECTORS.DANGER);\n            $(SELECTORS.ERROR).find('p').html(\"max 100 chars are allowed\");\n            $('#department').focus();\n            return false;\n        }\n\n        var promise = Ajax.call([{\n            methodname: 'theme_remui_save_user_profile_settings',\n            args: {\n                fname,\n                lname,\n                description,\n                city,\n                country,\n                phonenumber,\n                department,\n                address\n            }\n        }])[0];\n        promise.done(function () {\n            $(SELECTORS.ERROR).show();\n            $(SELECTORS.ERROR).removeClass(SELECTORS.DANGER).addClass(SELECTORS.SUCCESS);\n            $(SELECTORS.ERROR).find('p').css('margin', '0').html(M.util.get_string('detailssavedsuccessfully', 'theme_remui'));\n            setTimeout(function () {\n                $(SELECTORS.PROFILEABOUTMEWRAPPER).toggleClass('d-none');\n                $(SELECTORS.EDITPROFILEDETAILSWRAPPER).toggleClass('d-none');\n                $(SELECTORS.EDITICON).toggleClass('d-none');\n                $(SELECTORS.CANCELICON).toggleClass('d-none');\n                $('.profile-user').text(fname + \" \" + lname);\n                $('.usermenu a span.usertext').text(fname + \" \" + lname);\n                $('#user-description').text(description);\n                $('.prof-user-firstname').text(fname);\n                $('.prof-user-lastname').text(lname);\n                $('.prof-user-phone').text(phonenumber);\n                $('.prof-user-department').text(department);\n                $('.prof-user-desc').text(description);\n                $('.prof-user-country').text(countryname);\n                $('.prof-user-city').text(city);\n                $('.prof-user-address').text(address);\n            }, 1000)\n\n        })\n            .fail(function (ex) {\n                $(SELECTORS.ERROR).removeClass(SELECTORS.SUCCESS).addClass(SELECTORS.DANGER);\n                $(SELECTORS.ERROR).find('p')\n                    .css('margin', '0')\n                    .html(ex.errorcode + ' : ' + ex.error + ', ' + M.util.get_string('actioncouldnotbeperformed', 'theme_remui'));\n                Notification.exception(ex);\n            });\n\n        return false;\n    });\n\n    $(\".userbadgelink\").click(function () {\n        $(\"#aboutmetab\").trigger(\"click\");\n    });\n    $(\".usercontactsurl\").click(function () {\n        MessageDrawerHelper.show();\n        setTimeout(function () {\n            $(\"a[data-route='view-contacts']\").trigger(\"click\");\n        }, 200);\n\n    });\n    var summaryheight = $('.user-desc-target').height();\n    if (summaryheight > 110) {\n        $('.user-desc-target').find('#readmorebtn').removeClass('d-none');\n        $('.user-desc').addClass('ellipsis ellipsis-3');\n    }\n    $('#readmorebtn').on('click', function () {\n        $('.user-desc-target .user-desc').removeClass('ellipsis ellipsis-3');\n        $('.user-desc-target .user-desc').removeClass('ellipsis ellipsis-3');\n        $('.user-desc-target').find('#readmorebtn').addClass('d-none');\n        $('.user-desc-target').find('#readlessbtn').removeClass('d-none');\n    });\n    $('#readlessbtn').on('click', function () {\n        $('.user-desc-target .user-desc').addClass('ellipsis ellipsis-3');\n        $('.user-desc-target .user-desc').addClass('ellipsis ellipsis-3');\n        $('.user-desc-target').find('#readmorebtn').removeClass('d-none');\n        $('.user-desc-target').find('#readlessbtn').addClass('d-none');\n    });\n\n    $('.edit-profile-icon-wrapper .edw-icon-Edit').on('click', function () {\n        $(SELECTORS.PROFILEABOUTMEWRAPPER).addClass('d-none');\n        $(SELECTORS.EDITPROFILEDETAILSWRAPPER).removeClass('d-none');\n        $(SELECTORS.EDITICON).toggleClass('d-none');\n        $(SELECTORS.CANCELICON).toggleClass('d-none');\n        $(SELECTORS.ERROR).hide();\n    });\n\n    $('#btn-canel-changes').on('click', function () {\n        $(SELECTORS.EDITICON).toggleClass('d-none');\n        $(SELECTORS.CANCELICON).toggleClass('d-none');\n        $(SELECTORS.PROFILEABOUTMEWRAPPER).toggleClass('d-none');\n        $(SELECTORS.EDITPROFILEDETAILSWRAPPER).toggleClass('d-none');\n    })\n\n});\n"],"names":["define","$","Ajax","Notification","MessageDrawerHelper","SELECTORS","click","show","removeClass","addClass","find","html","fname","val","lname","phonenumber","department","country","countryname","text","city","trim","description","address","M","util","get_string","focus","match","length","call","methodname","args","done","css","setTimeout","toggleClass","fail","ex","errorcode","error","exception","trigger","height","on","hide"],"mappings":"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"}