{"version":3,"file":"userstats.min.js","sources":["../src/userstats.js"],"sourcesContent":["/* eslint-disable no-undef */\n/* eslint-disable max-len */\n/* eslint-disable require-jsdoc */\ndefine(['jquery', 'core/ajax', 'block_remuiblck/chartjs','theme_remui/bootstrap-select'], function($, Ajax) {\n    var myDoughnut = null;\n    var legendtemplatestr1 = \"<ul class=\\\"<%=name.toLowerCase()%>-legend\\\"><% for (var i=0; i<segments.length; i++){%>\";\n    var legendtemplatestr2 = \"<span style=\\\"background-color:<%=segments[i].fillColor%>\\\"></span>\";\n    var legendtemplatestr3 = \"<%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>\";\n    var pieOptions = {\n        // Boolean - Whether we should show a stroke on each segment\n        segmentShowStroke: true,\n        // String - The colour of each segment stroke\n        segmentStrokeColor: \"#fff\",\n        // Number - The width of each segment stroke\n        segmentStrokeWidth: 1,\n        // Number - The percentage of the chart that we cut out of the middle\n        percentageInnerCutout: 50, // This is 0 for Pie charts\n        // Number - Amount of animation steps\n        animationSteps: 100,\n        // String - Animation easing effect\n        /* animation: {\n            duration: 2000,\n            easing: \"easeOutBounce\"\n        },*/\n        // Boolean - Whether we animate the rotation of the Doughnut\n        animateRotate: true,\n        // Boolean - Whether we animate scaling the Doughnut from the centre\n        animateScale: false,\n        // Boolean - whether to make the chart responsive to window resizing\n        responsive: true,\n        // Boolean - whether to maintain the starting aspect ratio or not when responsive,\n        // if set to false, will take up entire container\n        maintainAspectRatio: true,\n        // String - A legend template\n        legendTemplate: legendtemplatestr1 + legendtemplatestr2 + legendtemplatestr3,\n        // String - A tooltip template\n        tooltipTemplate: \"<%=value %> <%=label%> users\",\n        legend: {\n            display: false,\n        },\n        plugins: {\n            legend: {\n              display: false\n            }\n        }\n    };\n\n    /**\n     * @param {String} response\n     */\n    function renderPieChart(response) {\n\n        if (myDoughnut !== null) {\n            myDoughnut.destroy();\n        }\n\n        var pieChartCanvas = $(\"#pieChartblock\").get(0).getContext(\"2d\");\n\n        var doughnutData = {\n            labels: response.labels,\n            datasets: [{\n                data: response.data,\n                backgroundColor: response.background_color,\n                hoverBackgroundColor: response.hoverBackground_color,\n            }]\n        };\n\n        myDoughnut = new Chart(pieChartCanvas, {type: 'doughnut', data: doughnutData, options: pieOptions});\n    }\n\n\n    /**\n     *\n     */\n    function createpiechart() {\n        var categoryId = $('#coursecategorylistblock option:selected').data('id');\n        Ajax.call([{\n            methodname: 'block_remuiblck_get_enrolled_users_by_category',\n            args: {\n                categoryid: categoryId\n            }\n        }])[0].done(function(response) {\n            if (response === null) {\n                $('canvas#pieChartblock').hide();\n                $('.enroll-stats-nouserserror').hide();\n                $('.chart-legend').hide();\n                $('.enroll-stats-error').show();\n            } else {\n                $('.enroll-stats-error').hide();\n                $('.enroll-stats-nouserserror').hide();\n                $('.chart-legend').show();\n                $('canvas#pieChartblock').show();\n\n                $('#enrolled_users_stats_block .chart-legend').empty();\n                var colors = ['#264485', '#0051F9', '#37BE71', '#4caf50', '#8bc34a', '#ffeb3b', '#ff9800', '#f44336', '#9c27b0', '#673ab7', '#3f51b5'];\n                $.each(response.labels, function (index, value) {\n                    $('#enrolled_users_stats_block .chart-legend').append('<li class=\"list-group-item d-flex align-items-center flex-gap-4 p-0\"><span class=\"badge badge-round text-trasparent\" style=\"background-color:' + colors[index] + ';\">1</span>' + '<span >' + value + ':' + '<span class=\"st-count\">' + response.data[index] + '</span>' + '</span>' + '</li>');\n                });\n\n                renderPieChart(response);\n            }\n\n        }).fail(function() {\n            $('canvas#pieChartblock').hide();\n            $('.enroll-stats-error').show();\n        });\n    }\n\n    // Update pie chart on category selection\n    if ($('#enrolled_users_stats_block select').length) {\n        $('#enrolled_users_stats_block select#coursecategorylistblock').on('change', function() {\n            createpiechart();\n        });\n        createpiechart();\n    }\n    $('.coursecategorylistblock').selectpicker();\n    // ----------------------------------\n    // - END PIE CHART - DOUGHNUT\n    // ----------------------------------\n\n});\n"],"names":["define","$","Ajax","myDoughnut","pieOptions","segmentShowStroke","segmentStrokeColor","segmentStrokeWidth","percentageInnerCutout","animationSteps","animateRotate","animateScale","responsive","maintainAspectRatio","legendTemplate","legendtemplatestr1","tooltipTemplate","legend","display","plugins","createpiechart","categoryId","data","call","methodname","args","categoryid","done","response","hide","show","empty","colors","each","labels","index","value","append","destroy","pieChartCanvas","get","getContext","doughnutData","datasets","backgroundColor","background_color","hoverBackgroundColor","hoverBackground_color","Chart","type","options","renderPieChart","fail","length","on","selectpicker"],"mappings":"AAGAA,mCAAO,CAAC,SAAU,YAAa,0BAA0B,iCAAiC,SAASC,EAAGC,UAC9FC,WAAa,KAIbC,WAAa,CAEbC,mBAAmB,EAEnBC,mBAAoB,OAEpBC,mBAAoB,EAEpBC,sBAAuB,GAEvBC,eAAgB,IAOhBC,eAAe,EAEfC,cAAc,EAEdC,YAAY,EAGZC,qBAAqB,EAErBC,eAAgBC,8NAEhBC,gBAAiB,+BACjBC,OAAQ,CACJC,SAAS,GAEbC,QAAS,CACLF,OAAQ,CACNC,SAAS,cAgCVE,qBACDC,WAAapB,EAAE,4CAA4CqB,KAAK,MACpEpB,KAAKqB,KAAK,CAAC,CACPC,WAAY,iDACZC,KAAM,CACFC,WAAYL,eAEhB,GAAGM,MAAK,SAASC,aACA,OAAbA,SACA3B,EAAE,wBAAwB4B,OAC1B5B,EAAE,8BAA8B4B,OAChC5B,EAAE,iBAAiB4B,OACnB5B,EAAE,uBAAuB6B,WACtB,CACH7B,EAAE,uBAAuB4B,OACzB5B,EAAE,8BAA8B4B,OAChC5B,EAAE,iBAAiB6B,OACnB7B,EAAE,wBAAwB6B,OAE1B7B,EAAE,6CAA6C8B,YAC3CC,OAAS,CAAC,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,WAC5H/B,EAAEgC,KAAKL,SAASM,QAAQ,SAAUC,MAAOC,OACrCnC,EAAE,6CAA6CoC,OAAO,gJAAkJL,OAAOG,OAAzJ,qBAA8LC,MAA9L,2BAAwOR,SAASN,KAAKa,OAAtP,mCA9C9CP,UAED,OAAfzB,YACAA,WAAWmC,cAGXC,eAAiBtC,EAAE,kBAAkBuC,IAAI,GAAGC,WAAW,MAEvDC,aAAe,CACfR,OAAQN,SAASM,OACjBS,SAAU,CAAC,CACPrB,KAAMM,SAASN,KACfsB,gBAAiBhB,SAASiB,iBAC1BC,qBAAsBlB,SAASmB,yBAIvC5C,WAAa,IAAI6C,MAAMT,eAAgB,CAACU,KAAM,WAAY3B,KAAMoB,aAAcQ,QAAS9C,aAgC/E+C,CAAevB,cAGpBwB,MAAK,WACJnD,EAAE,wBAAwB4B,OAC1B5B,EAAE,uBAAuB6B,UAK7B7B,EAAE,sCAAsCoD,SACxCpD,EAAE,8DAA8DqD,GAAG,UAAU,WACzElC,oBAEJA,kBAEJnB,EAAE,4BAA4BsD"}