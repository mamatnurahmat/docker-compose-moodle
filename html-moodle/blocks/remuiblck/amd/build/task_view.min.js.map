{"version":3,"file":"task_view.min.js","sources":["../src/task_view.js"],"sourcesContent":["/* eslint-disable camelcase */\n/* eslint-disable jsdoc/require-param */\n/* eslint-disable no-unused-vars */\ndefine([\n    'jquery',\n    'core/ajax',\n    'core/notification',\n    'core/templates',\n    'core/modal_factory',\n    'core/modal_events',\n    'core/fragment',\n    'block_remuiblck/modal_task_popup',\n    'block_remuiblck/events'\n], function(\n    $,\n    ajax,\n    Notification,\n    Templates,\n    ModalFactory,\n    ModalEvents,\n    Fragment,\n    ModalTaskPopup,\n    RemuiblckEvents\n) {\n    var SELECTORS = {\n        TASK_CONTAINER: '[data-region=\"task-list\"]',\n        PANEL: '.panel',\n        TASK_PROCESSING: '.task-processing'\n    };\n    var TEMPLATES = {\n        TASK_LIST_ITEMS: 'block_remuiblck/task-list-items'\n    };\n    var PROMISES = {\n        /**\n         * Get user tasks promise call\n         * @param  {String} duration duration selection\n         * @param  {String} status   status selection\n         * @param  {String} search   status selection\n         * @return {String} ajax promise\n         */\n        GET_USER_TASKS: function(duration, status, search) {\n            return ajax.call([{\n                methodname : 'block_remuiblck_get_user_tasks',\n                args: {\n                    duration: duration,\n                    status: status,\n                    search: search\n                }\n            }])[0];\n        }\n    };\n\n    /**\n     * Load task in the tasks list\n     * @param {DOM} root object\n     */\n    var loadTasks = function(root) {\n\n        var duration = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'today';\n        var status = arguments.length > 1 && arguments[2] !== undefined ? arguments[2] : 'all';\n        var search = arguments.length > 1 && arguments[3] !== undefined ? arguments[3] : '';\n\n        PROMISES.GET_USER_TASKS(duration, status, search).done(function(response) {\n            if (response.tasks.length == 0) {\n                response.no_tasks_image = M.util.image_url('empty_task_list', 'block_remuiblck');\n            }\n            var output = Templates.render(TEMPLATES.TASK_LIST_ITEMS, response);\n            output.done(function(html) {\n                $(root).find(SELECTORS.TASK_CONTAINER).html(html);\n                toggleTaskProcessing(root);\n            }).fail(function(ex) {\n                Notification.exception(ex);\n                toggleTaskProcessing(root);\n            });\n        }).fail(function(ex) {\n            Notification.exception(ex);\n            toggleTaskProcessing(root);\n        });\n    };\n\n    /**\n     * Load task on initialisation\n     * @param {DOM} root block DOM object\n     */\n    var init = function(root) {\n        loadTasks(root);\n    };\n\n    /**\n     * Toggle processing overlay to show that something happening in the background\n     * @param  {Dom} root\n     */\n    var toggleTaskProcessing = function(root) {\n        var show = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n        $(root).parents(SELECTORS.PANEL).find(SELECTORS.TASK_PROCESSING).toggleClass('show', show);\n    };\n    return {\n        init: init,\n        loadTasks: loadTasks,\n        toggleTaskProcessing: toggleTaskProcessing\n    };\n});\n"],"names":["define","$","ajax","Notification","Templates","ModalFactory","ModalEvents","Fragment","ModalTaskPopup","RemuiblckEvents","SELECTORS","TEMPLATES","PROMISES","duration","status","search","call","methodname","args","loadTasks","root","arguments","length","undefined","done","response","tasks","no_tasks_image","M","util","image_url","render","html","find","toggleTaskProcessing","fail","ex","exception","show","parents","toggleClass","init"],"mappings":"AAGAA,mCAAO,CACH,SACA,YACA,oBACA,iBACA,qBACA,oBACA,gBACA,mCACA,2BACD,SACCC,EACAC,KACAC,aACAC,UACAC,aACAC,YACAC,SACAC,eACAC,qBAEIC,yBACgB,4BADhBA,gBAEO,SAFPA,0BAGiB,mBAEjBC,0BACiB,kCAEjBC,wBAQgB,SAASC,SAAUC,OAAQC,eAChCb,KAAKc,KAAK,CAAC,CACdC,WAAa,iCACbC,KAAM,CACFL,SAAUA,SACVC,OAAQA,OACRC,OAAQA,WAEZ,IAQRI,UAAY,SAASC,UAEjBP,SAAWQ,UAAUC,OAAS,QAAsBC,IAAjBF,UAAU,GAAmBA,UAAU,GAAK,QAC/EP,OAASO,UAAUC,OAAS,QAAsBC,IAAjBF,UAAU,GAAmBA,UAAU,GAAK,MAC7EN,OAASM,UAAUC,OAAS,QAAsBC,IAAjBF,UAAU,GAAmBA,UAAU,GAAK,GAEjFT,wBAAwBC,SAAUC,OAAQC,QAAQS,MAAK,SAASC,UAC/B,GAAzBA,SAASC,MAAMJ,SACfG,SAASE,eAAiBC,EAAEC,KAAKC,UAAU,kBAAmB,oBAErD1B,UAAU2B,OAAOpB,0BAA2Bc,UAClDD,MAAK,SAASQ,MACjB/B,EAAEmB,MAAMa,KAAKvB,0BAA0BsB,KAAKA,MAC5CE,qBAAqBd,SACtBe,MAAK,SAASC,IACbjC,aAAakC,UAAUD,IACvBF,qBAAqBd,YAE1Be,MAAK,SAASC,IACbjC,aAAakC,UAAUD,IACvBF,qBAAqBd,UAgBzBc,qBAAuB,SAASd,UAC5BkB,KAAOjB,UAAUC,OAAS,QAAsBC,IAAjBF,UAAU,IAAmBA,UAAU,GAC1EpB,EAAEmB,MAAMmB,QAAQ7B,iBAAiBuB,KAAKvB,2BAA2B8B,YAAY,OAAQF,aAElF,CACHG,KAbO,SAASrB,MAChBD,UAAUC,OAaVD,UAAWA,UACXe,qBAAsBA"}