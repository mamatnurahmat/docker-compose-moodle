{"version":3,"file":"task_filters.min.js","sources":["../src/task_filters.js"],"sourcesContent":["define([\n    'jquery',\n    'core/custom_interaction_events',\n    'core/notification',\n    'block_remuiblck/events',\n    'block_remuiblck/task_view'\n], function(\n    $,\n    CustomEvents,\n    Notification,\n    RemuiblckEvents,\n    TaskView\n) {\n    var SELECTORS = {\n        TASK_DURATION_FILTER: '[data-region=\"task-duration-filter\"]',\n        TASK_STATUS_FILTER: '[data-region=\"task-status-filter\"]',\n        TASK_SEARCH_FILTER: '[data-region=\"task-search-filter\"]',\n        TASK_CANCEL_SEARCH: '[data-region=\"cancel-result\"]',\n        TASK_FILTER_OPTION: '[data-value]'\n    };\n\n    /**\n     * Event listener for the day selector (\"Next 7 days\", \"Next 30 days\", etc).\n     *\n     * @param {object} root The root element for the timeline block\n     */\n    var registerTaskDurationFilter = function(root) {\n        var taskDurationFilterContainer = $(root).find(SELECTORS.TASK_DURATION_FILTER);\n        CustomEvents.define(taskDurationFilterContainer, [CustomEvents.events.activate]);\n        taskDurationFilterContainer.on(\n            CustomEvents.events.activate,\n            SELECTORS.TASK_FILTER_OPTION,\n            function(e, data) {\n\n                var option = $(e.target).closest(SELECTORS.TASK_FILTER_OPTION);\n\n                if (option.hasClass('active')) {\n                    // If it's already active then we don't need to do anything.\n                    data.originalEvent.preventDefault();\n                    return;\n                }\n\n                $(e.target).trigger(RemuiblckEvents.TASK_DURATION_FILTER_CHANGE);\n\n                data.originalEvent.preventDefault();\n\n                TaskView.loadTasks(root, option.data('value'), getTaskStatus(root), getTaskSearch(root));\n            }\n        );\n    };\n\n    /**\n     * Get task duration dropdown selection\n     * @param  {DOM} root block DOM object\n     * @return {string} selected duration option\n     */\n    var getTaskDuration = function(root) {\n        return $(root).find(SELECTORS.TASK_DURATION_FILTER).find(SELECTORS.TASK_FILTER_OPTION + '.active').data('value');\n    };\n\n    /**\n     * Event listener for the day selector (\"Next 7 days\", \"Next 30 days\", etc).\n     *\n     * @param {object} root The root element for the timeline block\n     */\n    var registerTaskStatusFilter = function(root) {\n        var taskStatusFilterContainer = $(root).find(SELECTORS.TASK_STATUS_FILTER);\n        CustomEvents.define(taskStatusFilterContainer, [CustomEvents.events.activate]);\n        taskStatusFilterContainer.on(\n            CustomEvents.events.activate,\n            SELECTORS.TASK_FILTER_OPTION,\n            function(e, data) {\n\n                var option = $(e.target).closest(SELECTORS.TASK_FILTER_OPTION);\n\n                if (option.hasClass('active')) {\n                    // If it's already active then we don't need to do anything.\n                    data.originalEvent.preventDefault();\n                    return;\n                }\n\n                $(e.target).trigger(RemuiblckEvents.TASK_STATUS_FILTER_CHANGE);\n\n                data.originalEvent.preventDefault();\n\n                TaskView.loadTasks(root, getTaskDuration(root), option.data('value'), getTaskSearch(root));\n            }\n        );\n    };\n\n    /**\n     * Get task status dropdown selection\n     * @param {DOM} root block DOM object\n     * @return {string} selected status option\n     */\n    var getTaskStatus = function(root) {\n        return $(root).find(SELECTORS.TASK_STATUS_FILTER).find(SELECTORS.TASK_FILTER_OPTION + '.active').data('value');\n    };\n\n    /**\n     * Event listener for the search input\n     *\n     * @param {object} root The root element for the timeline block\n     */\n    var registerTaskSearchFilter = function(root) {\n        var taskSearchFilterContainer = $(root).find(SELECTORS.TASK_SEARCH_FILTER);\n        taskSearchFilterContainer.on(\n            RemuiblckEvents.TASK_SEARCH_FILTER_CHANGE,\n            function() {\n                TaskView.loadTasks(root, getTaskDuration(root), getTaskStatus(root), $(this).val());\n            }\n        );\n    };\n\n    /**\n     * Get task search input\n     * @param {DOM} root block DOM object\n     * @return {string} search query\n     */\n    var getTaskSearch = function(root) {\n        return $(root).find(SELECTORS.TASK_SEARCH_FILTER).val();\n    };\n\n    /**\n     * Initialise task filters events\n     * @param {DOM} root block DOM object\n     */\n    var init = function(root) {\n        registerTaskDurationFilter(root);\n        registerTaskStatusFilter(root);\n        registerTaskSearchFilter(root);\n        $('body').on('click', SELECTORS.TASK_CANCEL_SEARCH, function(e) {\n            e.preventDefault();\n            $(root).find(SELECTORS.TASK_SEARCH_FILTER).val('').trigger('input');\n            return;\n        });\n    };\n    return {\n        init: init,\n        getTaskDuration: getTaskDuration,\n        getTaskStatus: getTaskStatus\n    };\n});\n"],"names":["define","$","CustomEvents","Notification","RemuiblckEvents","TaskView","SELECTORS","getTaskDuration","root","find","data","getTaskStatus","getTaskSearch","val","init","taskDurationFilterContainer","events","activate","on","e","option","target","closest","hasClass","originalEvent","preventDefault","trigger","TASK_DURATION_FILTER_CHANGE","loadTasks","registerTaskDurationFilter","taskStatusFilterContainer","TASK_STATUS_FILTER_CHANGE","registerTaskStatusFilter","TASK_SEARCH_FILTER_CHANGE","this","registerTaskSearchFilter"],"mappings":"AAAAA,sCAAO,CACH,SACA,iCACA,oBACA,yBACA,8BACD,SACCC,EACAC,aACAC,aACAC,gBACAC,cAEIC,+BACsB,uCADtBA,6BAEoB,qCAFpBA,6BAGoB,qCAHpBA,6BAIoB,gCAJpBA,6BAKoB,eAsCpBC,gBAAkB,SAASC,aACpBP,EAAEO,MAAMC,KAAKH,gCAAgCG,KAAKH,6BAA+B,WAAWI,KAAK,UAsCxGC,cAAgB,SAASH,aAClBP,EAAEO,MAAMC,KAAKH,8BAA8BG,KAAKH,6BAA+B,WAAWI,KAAK,UAuBtGE,cAAgB,SAASJ,aAClBP,EAAEO,MAAMC,KAAKH,8BAA8BO,aAiB/C,CACHC,KAXO,SAASN,OArGa,SAASA,UAClCO,4BAA8Bd,EAAEO,MAAMC,KAAKH,gCAC/CJ,aAAaF,OAAOe,4BAA6B,CAACb,aAAac,OAAOC,WACtEF,4BAA4BG,GACxBhB,aAAac,OAAOC,SACpBX,8BACA,SAASa,EAAGT,UAEJU,OAASnB,EAAEkB,EAAEE,QAAQC,QAAQhB,8BAE7Bc,OAAOG,SAAS,UAEhBb,KAAKc,cAAcC,kBAIvBxB,EAAEkB,EAAEE,QAAQK,QAAQtB,gBAAgBuB,6BAEpCjB,KAAKc,cAAcC,iBAEnBpB,SAASuB,UAAUpB,KAAMY,OAAOV,KAAK,SAAUC,cAAcH,MAAOI,cAAcJ,WAkF1FqB,CAA2BrB,MA/DA,SAASA,UAChCsB,0BAA4B7B,EAAEO,MAAMC,KAAKH,8BAC7CJ,aAAaF,OAAO8B,0BAA2B,CAAC5B,aAAac,OAAOC,WACpEa,0BAA0BZ,GACtBhB,aAAac,OAAOC,SACpBX,8BACA,SAASa,EAAGT,UAEJU,OAASnB,EAAEkB,EAAEE,QAAQC,QAAQhB,8BAE7Bc,OAAOG,SAAS,UAEhBb,KAAKc,cAAcC,kBAIvBxB,EAAEkB,EAAEE,QAAQK,QAAQtB,gBAAgB2B,2BAEpCrB,KAAKc,cAAcC,iBAEnBpB,SAASuB,UAAUpB,KAAMD,gBAAgBC,MAAOY,OAAOV,KAAK,SAAUE,cAAcJ,WA4C5FwB,CAAyBxB,MAzBE,SAASA,MACJP,EAAEO,MAAMC,KAAKH,8BACnBY,GACtBd,gBAAgB6B,2BAChB,WACI5B,SAASuB,UAAUpB,KAAMD,gBAAgBC,MAAOG,cAAcH,MAAOP,EAAEiC,MAAMrB,UAqBrFsB,CAAyB3B,MACzBP,EAAE,QAAQiB,GAAG,QAASZ,8BAA8B,SAASa,GACzDA,EAAEM,iBACFxB,EAAEO,MAAMC,KAAKH,8BAA8BO,IAAI,IAAIa,QAAQ,aAM/DnB,gBAAiBA,gBACjBI,cAAeA"}